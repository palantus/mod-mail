<!doctype html>
<head>
<meta charset="utf-8" />
	<title>Mail</title>
	<meta http-equiv="X-UA-Compatible" content="IE=10,IE=9,IE=8,IE=edge" />
	<meta name="viewport" content="width=device-width, user-scalable=no">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<link rel="shortcut icon" sizes="1024x1024" href="/mail/img/mail.png">
	
	<!--<link rel="stylesheet" type="text/css" href="/mail/css/mail.css" />-->
	
	<!-- To avoid background blinking on refresh -->
	<style>html{background-color: lightgrey}</style>

	<script src="/js/jquery.min.js"></script>
	<script src="/js/framework.js"></script>
	<!--<script src="/mail/js/mail.js"></script>-->
	
	<script>
		request({module:"mail", type: "GetRecentMailList", isSpam: getUrlVar("spam") == "true"}, function(res){
			for(i in res){
				var isHTML = res[i].bodyHTML != "" ? true : false;

				var header = $("<div/>", {class: "mailheader"});
				var to = $("<div/>", {html: "<span>To: </span>" + res[i].to});
				var from = $("<div/>", {html: "<span>From: </span>" + res[i].from});
				var subject = $("<div/>", {html: "<span>Subject: </span>" + res[i].title});

				header.append(from);
				header.append(to);
				header.append(subject);

				var body = $("<div/>", {class: "mailbody" + (isHTML?"":" plain"), html: (isHTML ? res[i].bodyHTML : res[i].bodyPlain)});

				var container = $("<div/>", {class: "mailcontainer"});
				container.append(header);
				container.append(body);

				$("#mails").append(container);
			}
		});
	</script>

	<style>
		div.mailcontainer{
			margin-top: 20px;
			background-color: white; 
			padding: 5px; 
			box-shadow: 5px 5px 5px #000; 
			margin-bottom: 20px;
		}
		div.mailcontainer div.mailbody{
			margin-top: 10px;
		}
		div.mailcontainer .mailbody.plain{
			white-space: pre;
		}

		div.mailheader span{
			width: 70px;
			display: inline-block;
			font-weight: bold;
		}
	</style>
</head>
<body>
	<a href="/user/login.html"><button>Log in/out</button></a><a href="/mail/setup.html"><button>Setup</button></a><br/>
	<div id="mails"></div>
</body>
</html>